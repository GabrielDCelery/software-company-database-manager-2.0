var DatabaseApp=angular.module("DatabaseApp",["ngRoute","ngCookies","AuthCtrl","AuthFactory","CompaniesCtrl","CompaniesFactory","MailingCtrl","MailingFactory","SubMenuFactory","FilteredSearchFactory"]);DatabaseApp.config(["$routeProvider","$locationProvider",function(e,a){e.when("/companies",{templateUrl:"templates/companies/_companies_main.html",controller:"CompaniesCtrl"}).when("/mailing",{templateUrl:"templates/mailing/_mailing_main.html",controller:"MailingCtrl"}).otherwise({redirectTo:"/"}),a.html5Mode(!0)}]);var AuthCtrl=angular.module("AuthCtrl",[]);AuthCtrl.controller("AuthCtrl",["$scope","AuthFactory",function(e,a){function t(t,n){a.login(t,n,function(r){r.data?(e.loggedIn=!0,a.setLoginCookie(t,n)):e.loggedIn=!1})}function n(){e.loggedIn=!1,a.clearLoginCookie()}function r(e){a.getLoginCookie(e)}e.loggedIn=!1,e.login=t,e.logout=n,r(t)}]);var AuthFactory=angular.module("AuthFactory",[]);AuthFactory.factory("AuthFactory",["$http","$cookies",function(e,a){function t(a,t,n){e.post("php/login.php",{username:a,password:t}).success(n)}function n(e,t){var n=i.encode(e),r=i.encode(t),o={username:n,password:r};a.putObject("userCookie",o)}function r(){a.remove("userCookie")}function o(e){var t=a.getObject("userCookie");if(t){var n=i.decode(t.username),r=i.decode(t.password);e(n,r)}}var i={keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var a,t,n,r,o,i="",c="",l="",s=0;do a=e.charCodeAt(s++),t=e.charCodeAt(s++),c=e.charCodeAt(s++),n=a>>2,r=(3&a)<<4|t>>4,o=(15&t)<<2|c>>6,l=63&c,isNaN(t)?o=l=64:isNaN(c)&&(l=64),i=i+this.keyStr.charAt(n)+this.keyStr.charAt(r)+this.keyStr.charAt(o)+this.keyStr.charAt(l),a=t=c="",n=r=o=l="";while(s<e.length);return i},decode:function(e){var a,t,n,r,o,i="",c="",l="",s=0,u=/[^A-Za-z0-9\+\/\=]/g;u.exec(e)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do n=this.keyStr.indexOf(e.charAt(s++)),r=this.keyStr.indexOf(e.charAt(s++)),o=this.keyStr.indexOf(e.charAt(s++)),l=this.keyStr.indexOf(e.charAt(s++)),a=n<<2|r>>4,t=(15&r)<<4|o>>2,c=(3&o)<<6|l,i+=String.fromCharCode(a),64!=o&&(i+=String.fromCharCode(t)),64!=l&&(i+=String.fromCharCode(c)),a=t=c="",n=r=o=l="";while(s<e.length);return i}};return{login:t,setLoginCookie:n,clearLoginCookie:r,getLoginCookie:o}}]);var CompaniesCtrl=angular.module("CompaniesCtrl",[]);CompaniesCtrl.controller("CompaniesCtrl",["$scope","$http","subMenu","filteredSearch",function(e,a,t,n){function r(a){n.filterCompanyNames(a,function(a){e.filteredListOfCompanies=a})}function o(a){e.form.searchCompany.companyName=a,e.filteredListOfCompanies=[]}function i(a){n.filterManagerNames(a,function(a){e.filteredListOfManagers=a})}function c(a){e.form.searchCompany.managerName=a,e.filteredListOfManagers=[]}function l(a){t.displayContent(e.display.form,a,function(a){e.display.form=a})}function s(){e.display=angular.copy(u)}e.display={form:{searchCompany:!1,sendEmail:!1,showDetails:!1,extendContract:!1,addNewCompany:!1}},e.form={searchCompany:{companyName:"",managerName:"",validContract:!0,expiredContract:!1,startingDate:null,endingDate:null,lastContractOnly:!0}},e.filteredListOfCompanies=[],e.filteredListOfManagers=[];var u=angular.copy(e.display);e.menu=l,e.reset=s,e.filterListOfCompanyNames=r,e.filterListOfManagerNames=i,e.insertCompanyNameToInputField=o,e.insertManagerNameToInputField=c}]);var CompaniesFactory=angular.module("CompaniesFactory",[]);CompaniesFactory.factory("CompaniesFactory",[function(){}]);var MailingCtrl=angular.module("MailingCtrl",[]);MailingCtrl.controller("MailingCtrl",["$scope","subMenu",function(e,a){function t(t){a.displayContent(e.display.form,t,function(a){e.display.form=a})}function n(){e.display=angular.copy(r)}e.display={form:{searchMails:!1,forwardMails:!1,editMails:!1,addNewMails:!1}};var r=angular.copy(e.display);e.menu=t,e.reset=n}]);var MailingFactory=angular.module("MailingFactory",[]);MailingFactory.factory("MailingFactory",["$http",function(e){}]);var SubMenuFactory=angular.module("SubMenuFactory",[]);SubMenuFactory.factory("subMenu",[function(){function e(e,a,t){for(var n in e)n==a?e[n]=!0:e[n]=!1;t(e)}return{displayContent:e}}]);var FilteredSearchFactory=angular.module("FilteredSearchFactory",[]);FilteredSearchFactory.factory("filteredSearch",["$http",function(e){function a(a){i?a(i):e.get("php/companies/fetch_company_names.php").success(function(e){i=e,a(e)})}function t(a){c?a(c):e.get("php/companies/fetch_manager_names.php").success(function(e){c=e,a(e)})}function n(e,a){var t=a,n=[];if(0!==e.length)for(var r=0;r<t.length;r++)t[r].substring(0,e.length).toLowerCase()===e.toLowerCase()&&n.push(t[r]);return n}function r(e,t){a(function(a){t(n(e,a))})}function o(e,a){t(function(t){a(n(e,t))})}var i,c;return{filterCompanyNames:r,filterManagerNames:o}}]);